"use strict";(self.webpackChunkltcgi=self.webpackChunkltcgi||[]).push([[276],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>h});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),c=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(r),h=n,m=d["".concat(s,".").concat(h)]||d[h]||u[h]||i;return r?a.createElement(m,o(o({ref:t},p),{},{components:r})):a.createElement(m,o({ref:t},p))}));function h(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,o[1]=l;for(var c=2;c<i;c++)o[c]=r[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},4122:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var a=r(7462),n=(r(7294),r(3905));const i={sidebar_position:11},o="\ud83e\ude84 For Shader Authors",l={unversionedId:"Advanced/Shader_Authors",id:"Advanced/Shader_Authors",title:"\ud83e\ude84 For Shader Authors",description:"The recommended way to include LTCGI support in your shader is by including the LTCGI.cginc file in your shader from the import path of this prefab. I.e. do not copy the code and distribute it with your shader, but simply include it if it exists (you can check with the LTCGI_INCLUDED define in C#).",source:"@site/docs/Advanced/Shader_Authors.md",sourceDirName:"Advanced",slug:"/Advanced/Shader_Authors",permalink:"/Advanced/Shader_Authors",draft:!1,tags:[],version:"current",sidebarPosition:11,frontMatter:{sidebar_position:11},sidebar:"tutorialSidebar",previous:{title:"\u26a0\ufe0f Debug Builds",permalink:"/Advanced/Debug_Versions"},next:{title:"1\ufe0f\u20e3 VRChat Worlds",permalink:"/Getting Started/Installation/VRChat"}},s={},c=[{value:"The LTCGI v2 API",id:"the-ltcgi-v2-api",level:2},{value:"Sampler slots",id:"sampler-slots",level:2},{value:"Amplify",id:"amplify",level:2}],p={toc:c};function u(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"-for-shader-authors"},"\ud83e\ude84 For Shader Authors"),(0,n.kt)("p",null,"The recommended way to include LTCGI support in your shader is by including the ",(0,n.kt)("inlineCode",{parentName:"p"},"LTCGI.cginc")," file in your shader from the import path of this prefab. I.e. do not copy the code and distribute it with your shader, but simply include it if it exists (you can check with the ",(0,n.kt)("inlineCode",{parentName:"p"},"LTCGI_INCLUDED")," define in C#)."),(0,n.kt)("p",null,"To have the controller recognize your shader as LTCGI compatible, you need to include a tag named ",(0,n.kt)("inlineCode",{parentName:"p"},"LTCGI")," which can either have the value ",(0,n.kt)("inlineCode",{parentName:"p"},"ALWAYS")," or the name of a shader property (I believe in upper-case only?) on which LTCGI support depends (e.g. a ",(0,n.kt)("inlineCode",{parentName:"p"},"[Toggle]")," or ",(0,n.kt)("inlineCode",{parentName:"p"},"[ToggleUI]"),")."),(0,n.kt)("p",null,"See z3y's integration for an example: ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/z3y/shaders/commit/0ff546a874c6ab7dc12f5762f895f3cb76b8164e"},"https://github.com/z3y/shaders/commit/0ff546a874c6ab7dc12f5762f895f3cb76b8164e")),(0,n.kt)("p",null,"Note that this method of distribution does not encumber your shader with any additional licenses."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"\ud83d\ude4b\u200d\u2642\ufe0f If you implement LTCGI into your shader, feel free to send a PR to be included in the README!")),(0,n.kt)("h2",{id:"the-ltcgi-v2-api"},"The LTCGI v2 API"),(0,n.kt)("p",null,"For more advanced shader use-cases, LTCGI provides an API to get more detailed callbacks for each light source. This allows better integration with your shading model."),(0,n.kt)("p",null,"A documented example for and APIv2 is given with the ",(0,n.kt)("inlineCode",{parentName:"p"},"LTCGI_Surface_v2.shader"),": ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/PiMaker/ltcgi/blob/main/Shaders/LTCGI_Surface_v2.shader"},"https://github.com/PiMaker/ltcgi/blob/main/Shaders/LTCGI_Surface_v2.shader")),(0,n.kt)("p",null,"The callbacks receive certain structs, which can be checked out here: ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/PiMaker/ltcgi/blob/main/Shaders/LTCGI_structs.cginc"},"https://github.com/PiMaker/ltcgi/blob/main/Shaders/LTCGI_structs.cginc")),(0,n.kt)("p",null,'The idea is that you define callback functions as well as a custom "data" struct that serves as your custom accumulator/"return" type. These callbacks will then be used instead of simply summing up ',(0,n.kt)("inlineCode",{parentName:"p"},"intensity * color")," for each light and returning specular+diffuse contributions."),(0,n.kt)("p",null,"I recommend using this API going forward, even though it is somewhat experimental. Please leave feedback on my Discord!"),(0,n.kt)("h2",{id:"sampler-slots"},"Sampler slots"),(0,n.kt)("p",null,"LTCGI only uses a single ",(0,n.kt)("inlineCode",{parentName:"p"},"SamplerState"),", but can be configured to use 0 as well. To do so, set the macro ",(0,n.kt)("inlineCode",{parentName:"p"},"LTCGI_SAMPLER")," to your sampler before importing LTCGI. It should be clamp+trilinear, anisotropic is okay but not required."),(0,n.kt)("p",null,"The default sampler is declared as:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-csharp"},"SamplerState sampler_LTCGI_trilinear_clamp_sampler;\n")),(0,n.kt)("p",null,"By necessity, LTCGI uses a non-trivial number of texture slots however. By using ",(0,n.kt)("inlineCode",{parentName:"p"},"LTCGI_ALWAYS_LTC_DIFFUSE")," (default in avatar mode) you can at least get rid of one, the lightmap."),(0,n.kt)("h2",{id:"amplify"},"Amplify"),(0,n.kt)("p",null,"There is an Amplify example available at ",(0,n.kt)("inlineCode",{parentName:"p"},"Packages/at.pimaker.ltcgi/Shaders/Amplify/LTCGI_Amplify.shader"),".",(0,n.kt)("br",{parentName:"p"}),"\n","You can open that file in Amplify Shader Editor to see how it is configured."),(0,n.kt)("p",null,"In general, the steps are:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Configure the ",(0,n.kt)("inlineCode",{parentName:"li"},"#include")," and custom tag")),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://github.com/PiMaker/ltcgi/raw/main/~Screenshots/amplify1.jpg",alt:"Amplify Example 1"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Add a ",(0,n.kt)("inlineCode",{parentName:"li"},"LTCGI_Contribution")," node (under ",(0,n.kt)("inlineCode",{parentName:"li"},"Functions"),") and connect it")),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://github.com/PiMaker/ltcgi/raw/main/~Screenshots/amplify3.jpg",alt:"Amplify Example 3"}),(0,n.kt)("br",{parentName:"p"}),"\n","Check the example linked above to see which parameter values are expected."))}u.isMDXComponent=!0}}]);